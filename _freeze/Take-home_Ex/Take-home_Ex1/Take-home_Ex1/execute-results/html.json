{
  "hash": "6524274cf71db5763f2c00b29fccca23",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Heart Attack in Japan (Youth vs Adult)\"\nauthor: \"Enrico Limberg\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n    echo: true\n    eval: true\n    warning: false\n    freeze: true\n---\n\n\n\n# 1.0 Overview\n\n## 1.1 Background\n\nCardiovascular diseases are major health issue worldwide, and Japan is facing similar issues. With both lifestyle changes and aging population, it is crucial to understand the factors that lead to heart attacks, especially among different age groups. This analysis will focus on heart attack cases in Japan, by comparing both youth and adults to see how age impacts health risks.\n\n## 1.2 Objective\n\nThe main goal of this analysis is to explore the difference in heart attack occurences between youth and adults in Japan. By examining risk factors, medical indicators, and lifestyle choices, we aim to identify trends that can provide insights to help with the development of health initiatives and interventions that are specifically tailored to each age group.\n\n# 2. Data Overview\n\n## 2.1 Dataset Description\n\nThe dataset provides a detailed look at heart attack incidents in Japan, highlighting differences between youth and adults. It includes a variety of features, such as demographic information, medical indicators like cholesterol and blood pressure, physical metrics like BMI, and lifestyle factors. This comprehensive data allows for a deeper analysis of what influences heart attack risks.\n\n## 2.2 Target Audience\n\nThe insights from this analysis will benefit several groups. Data scientists and analysts can use the findings for predictive modeling. Healthcare professionals can apply this information to better address age-specific health risks. Policymakers can use the insights to create effective public health initiatives, while educators and researchers can draw on the data for academic studies.\n\n3.  Getting Started\n\n3.1 Importing the tools\n\nThe R packages that are going to be used for this exercises are:\n\n-   **tidyverse** to perform data science task such as reading rectangular data, tidying up data, manipulating data and creating graphics.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,ggplot2,ggridges,ggdist,ggpubr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(ggdist)\nlibrary(ggpubr)\n```\n:::\n\n\n\n3.2 Importing Data\n\nThe dataset that are used for this take-home exercise will be the *`japan_heart_attack_dataset.csv`*, which is in the csv file format.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth <- read_csv(\"data/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n3.3 Creating an Agre Group Column\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth <- health %>%\n  mutate(Age_Group = case_when(\n    Age < 40 ~ \"Youth\",\n    Age >= 40 ~ \"Adult\"\n  ))\n```\n:::\n\n\n\n4.0 Data Visualization\n\n4.1 Distribution of Heart Attacks by Age Group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Age, fill = Age_Group)) +\n  geom_histogram(bins = 30, alpha = 0.7, position = \"identity\") +\n  labs(title = \"Heart Attack Distribution by Age\", x = \"Age\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n4.2 Cholesterol Levels in Youth vs Adults\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Age_Group, y = Cholesterol_Level, fill = Age_Group)) +\n  geom_boxplot() +\n  labs(title = \"Cholesterol Levels by Age Group\", x = \"Age Group\", y = \"Cholesterol\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n4.3 Blood Pressure vs. Heart Attack Risk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth <- health %>%\n  mutate(MAP = (Systolic_BP + (2 * Diastolic_BP)) / 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Systolic_BP, y = Diastolic_BP, color = Age_Group)) +\n  geom_point(alpha = 0.5) +\n  labs(title = \"Systolic vs. Diastolic Blood Pressure by Age Group\",\n       x = \"Systolic Blood Pressure\", y = \"Diastolic Blood Pressure\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Age_Group, y = MAP, fill = Age_Group)) +\n  geom_boxplot() +\n  labs(title = \"Mean Arterial Pressure (MAP) by Age Group\",\n       x = \"Age Group\", y = \"MAP\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## Checking Distribution of Hypertension Among Heart Attack Patients \n\nThis will show how many people with and without hypertension had heart attacks. If more people with hypertension have heart attacks, it suggest a strong correlation between hypertension and heart disease.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Hypertension_History, fill = factor(Heart_Attack_Occurrence))) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Hypertension History vs. Heart Attack Risk\",\n       x = \"Hypertension History\", y = \"Count\",\n       fill = \"Heart Attack (Yes=1, No=0)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth %>%\n  group_by(Hypertension_History) %>%\n  summarise(Heart_Attack_Occurrence = mean(Heart_Attack_Occurrence)) %>%\n  ggplot(aes(x = Hypertension_History, y = Heart_Attack_Occurrence, fill = Hypertension_History)) +\n  geom_col() +\n  labs(title = \"Heart Attack Proportion by Hypertension Status\",\n       x = \"Hypertension History\", y = \"Heart Attack Rate\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(table(health$Hypertension_History, health$Heart_Attack_Occurrence))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(health$Hypertension_History, health$Heart_Attack_Occurrence)\nX-squared = 0.39547, df = 1, p-value = 0.5294\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nyouth_data <- health %>% filter(Age_Group == \"Youth\")\nadult_data <- health %>% filter(Age_Group == \"Adult\")\n\nchisq.test(table(youth_data$Hypertension_History, youth_data$Heart_Attack_Occurrence)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(youth_data$Hypertension_History, youth_data$Heart_Attack_Occurrence)\nX-squared = 2.438, df = 1, p-value = 0.1184\n```\n\n\n:::\n\n```{.r .cell-code}\nchisq.test(table(adult_data$Hypertension_History, adult_data$Heart_Attack_Occurrence)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(adult_data$Hypertension_History, adult_data$Heart_Attack_Occurrence)\nX-squared = 0.1188, df = 1, p-value = 0.7303\n```\n\n\n:::\n:::\n\n\n\nThis chart compares heart attack occurrence rates between the youth and adult age groups. It helps identify which age group experiences more heart attack cases.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Age_Group, fill = Heart_Attack_Occurrence)) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Heart Attack Occurrence by Age Group\",\n       x = \"Age Group\",\n       y = \"Count of Heart Attacks\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Age_Group, y = Cholesterol_Level)) +\n  geom_boxplot() +\n  labs(title = \"Cholesterol Levels by Age Group\",\n       x = \"Age Group\",\n       y = \"Cholesterol Level\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Diet_Quality, fill = Heart_Attack_Occurrence)) +\n  facet_wrap(~ Age_Group) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Diet Quality vs. Heart Attack by Age Group\",\n       x = \"Diet Quality\",\n       y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(health, aes(x = Family_History, fill = Heart_Attack_Occurrence)) +\n  facet_wrap(~ Age_Group) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Family History vs. Heart Attack by Age Group\",\n       x = \"Family History\",\n       y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n\ncholesterol_summary <- health %>%\n  group_by(Age_Group) %>%\n  summarise(\n    mean_chol = mean(Cholesterol_Level, na.rm = TRUE),\n    sd_chol = sd(Cholesterol_Level, na.rm = TRUE),\n    n = n(),\n    lower_ci = mean_chol - qt(0.975, df = n-1) * sd_chol / sqrt(n),  # 95% CI lower\n    upper_ci = mean_chol + qt(0.975, df = n-1) * sd_chol / sqrt(n)   # 95% CI upper\n  )\n\n# Funnel plot with confidence intervals and trend line\nggplot(cholesterol_summary, aes(x = Age_Group, y = mean_chol)) +\n  geom_point(aes(color = mean_chol), size = 4) +  # Points for the means\n  geom_errorbar(aes(ymin = lower_ci, ymax = upper_ci), width = 0.2) +  # Confidence intervals\n  geom_smooth(aes(y = mean_chol), method = \"loess\", se = FALSE, color = \"blue\", size = 1.2) +  # Trendline\n  coord_flip() +\n  ggtitle(\"Funnel Plot of Cholesterol Levels by Age Group\") +\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.title.y = element_text(angle = 360, vjust = 0.5, hjust = 1)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Faceted bar plot comparing Smoking History vs Heart Attack Occurrence by Age Group\nggplot(health, aes(x = Smoking_History, fill = Heart_Attack_Occurrence)) +\n  geom_bar(position = \"fill\") +\n  facet_wrap(~ Age_Group) +\n  labs(title = \"Smoking History and Heart Attack Occurrence by Age Group\",\n       y = \"Proportion of Heart Attack Occurrence\",\n       x = \"Smoking History\") +\n  scale_fill_manual(values = c(\"No\" = \"lightblue\", \"Yes\" = \"darkred\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfunnel_data <- health %>%\n  filter(!is.na(Heart_Attack_Occurrence), !is.na(Age_Group)) %>%\n  group_by(Age_Group) %>%\n  summarise(\n    num_heart_attack = sum(Heart_Attack_Occurrence == \"Yes\", na.rm = TRUE),\n    total = n(),\n    prop_heart_attack = num_heart_attack / total\n  ) %>%\n  mutate(\n    lower_ci = prop_heart_attack - 1.96 * sqrt((prop_heart_attack * (1 - prop_heart_attack)) / total),\n    upper_ci = prop_heart_attack + 1.96 * sqrt((prop_heart_attack * (1 - prop_heart_attack)) / total)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfunnel_data <- funnel_data %>%\n  mutate(\n    prop_heart_attack = pmin(pmax(prop_heart_attack, 0.001), 0.05),  # Cap proportions between 0.001 and 0.05\n    lower_ci = pmin(pmax(lower_ci, 0.001), 0.05),  # Cap lower confidence interval\n    upper_ci = pmin(pmax(upper_ci, 0.001), 0.05)   # Cap upper confidence interval\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfunnel_data <- funnel_data %>%\n  filter(!is.na(lower_ci) & !is.na(upper_ci))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Plot the funnel plot for Heart Attack Proportions\nggplot(funnel_data, aes(x = Age_Group, y = prop_heart_attack)) +\n  geom_point(aes(color = Age_Group), size = 4) +  # Points for proportions\n  geom_errorbar(aes(ymin = lower_ci, ymax = upper_ci), width = 0.2) +  # Confidence intervals\n  coord_flip() +  # Flip coordinates for better readability\n  scale_y_continuous(limits = c(0, 0.05)) +  # Set y-axis range (proportion)\n  scale_x_discrete(limits = c(\"Youth\", \"Adult\")) +  # Set x-axis to Age Group\n  ggtitle(\"Funnel Plot: Heart Attack Occurrence by Age Group\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}